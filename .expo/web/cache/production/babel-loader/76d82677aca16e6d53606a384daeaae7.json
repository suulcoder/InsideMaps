{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";var _marked=_regeneratorRuntime.mark(createMap),_marked2=_regeneratorRuntime.mark(watchCreateMap);import{call,takeEvery,put,select}from'redux-saga/effects';import*as actions from\"../actions/map\";import*as types from\"../types/map\";import*as selectors from\"../reducers\";import{bodyParser}from\"../modules/parser\";var API_BASE_URL='https://inside-maps-api.herokuapp.com/api/v1/map/';function createMap(action){var map,oldId,token,response,_yield$response$json,result,_map;return _regeneratorRuntime.wrap(function createMap$(_context){while(1){switch(_context.prev=_context.next){case 0:map=action.payload;oldId=map._id;console.log(\"Esto le mando desde el saga\",action.payload);_context.prev=3;if(!true){_context.next=26;break;}_context.next=7;return select(selectors.getAuthToken);case 7:token=_context.sent;_context.next=10;return call(fetch,API_BASE_URL,{method:'POST',body:JSON.stringify(action.payload),headers:{Accept:'application/json','Content-Type':'application/json','Authorization':\"JWT \".concat(token)}});case 10:response=_context.sent;if(!(response.status>=200&&response.status<=300)){_context.next=22;break;}_context.next=14;return response.json();case 14:_yield$response$json=_context.sent;result=_yield$response$json.result;_map=result;_context.next=19;return put(actions.completeCreatingMap(oldId,_map));case 19:console.log(\"Se creo un nuevo mapa exitosamente!\",_map);_context.next=24;break;case 22:console.log(\"Error en la respuesta!\");console.log(\"llega el estatus\",response);case 24:_context.next=27;break;case 26:console.log('Error de autenticaciÃ³n');case 27:_context.next=34;break;case 29:_context.prev=29;_context.t0=_context[\"catch\"](3);console.log(_context.t0);_context.next=34;return put(actions.failCreatingMap(oldId,_context.t0));case 34:case\"end\":return _context.stop();}}},_marked,null,[[3,29]]);}export function watchCreateMap(){return _regeneratorRuntime.wrap(function watchCreateMap$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return takeEvery(types.CREATE_MAP_STARTED,createMap);case 2:case\"end\":return _context2.stop();}}},_marked2);}","map":{"version":3,"sources":["/home/thecoder/Documentos/UVG/Software/InsideMaps/src/sagas/map.js"],"names":["createMap","watchCreateMap","call","takeEvery","put","select","actions","types","selectors","bodyParser","API_BASE_URL","action","map","payload","oldId","_id","console","log","getAuthToken","token","fetch","method","body","JSON","stringify","headers","Accept","response","status","json","result","completeCreatingMap","failCreatingMap","CREATE_MAP_STARTED"],"mappings":"iGAgBUA,S,oCA+COC,c,EA/DjB,OACEC,IADF,CAEEC,SAFF,CAGEC,GAHF,CAIEC,MAJF,KAKO,oBALP,CAOA,MAAO,GAAKC,CAAAA,OAAZ,sBACA,MAAO,GAAKC,CAAAA,KAAZ,oBACA,MAAO,GAAKC,CAAAA,SAAZ,mBACA,OAASC,UAAT,yBAGA,GAAMC,CAAAA,YAAY,CAAG,mDAArB,CAGA,QAAUV,CAAAA,SAAV,CAAoBW,MAApB,kLACQC,GADR,CACeD,MAAM,CAACE,OADtB,CAEQC,KAFR,CAEgBF,GAAG,CAACG,GAFpB,CAGEC,OAAO,CAACC,GAAR,CAAY,6BAAZ,CAA2CN,MAAM,CAACE,OAAlD,EAHF,oBAOO,IAPP,0CASoB,MAAMR,CAAAA,MAAM,CAACG,SAAS,CAACU,YAAX,CAAZ,CATpB,OASYC,KATZ,gCAWuB,MAAMjB,CAAAA,IAAI,CACzBkB,KADyB,CAEzBV,YAFyB,CAGzB,CACEW,MAAM,CAAE,MADV,CAEEC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeb,MAAM,CAACE,OAAtB,CAFR,CAGEY,OAAO,CAAE,CAEPC,MAAM,CAAE,kBAFD,CAGP,eAAgB,kBAHT,CAIP,8BAAwBP,KAAxB,CAJO,CAHX,CAHyB,CAAV,CAXvB,QAWYQ,QAXZ,oBA0BSA,QAAQ,CAACC,MAAT,EAAmB,GAAnB,EAA0BD,QAAQ,CAACC,MAAT,EAAmB,GA1BtD,4CA2B2B,MAAMD,CAAAA,QAAQ,CAACE,IAAT,EAAN,CA3B3B,2CA2BgBC,MA3BhB,sBA2BgBA,MA3BhB,CA4BclB,IA5Bd,CA4BoBkB,MA5BpB,kBA6BQ,MAAM1B,CAAAA,GAAG,CAACE,OAAO,CAACyB,mBAAR,CAA4BjB,KAA5B,CAAmCF,IAAnC,CAAD,CAAT,CA7BR,QA8BQI,OAAO,CAACC,GAAR,CAAY,qCAAZ,CAAmDL,IAAnD,EA9BR,+BAgCQI,OAAO,CAACC,GAAR,CAAY,wBAAZ,EACAD,OAAO,CAACC,GAAR,CAAY,kBAAZ,CAAgCU,QAAhC,EAjCR,uCAqCMX,OAAO,CAACC,GAAR,CAAY,wBAAZ,EArCN,yFA0CID,OAAO,CAACC,GAAR,cA1CJ,iBA2CI,MAAMb,CAAAA,GAAG,CAACE,OAAO,CAAC0B,eAAR,CAAwBlB,KAAxB,aAAD,CAAT,CA3CJ,qEA+CA,MAAO,SAAUb,CAAAA,cAAV,8IACL,MAAME,CAAAA,SAAS,CACbI,KAAK,CAAC0B,kBADO,CAEbjC,SAFa,CAAf,CADK","sourcesContent":["import {\n  call,\n  takeEvery,\n  put,\n  select,\n} from 'redux-saga/effects';\n\nimport * as actions from '../actions/map';\nimport * as types from '../types/map';\nimport * as selectors from '../reducers';\nimport { bodyParser } from '../modules/parser';\n\n\nconst API_BASE_URL = 'https://inside-maps-api.herokuapp.com/api/v1/map/';\n\n\nfunction* createMap(action) {\n  const map  = action.payload;\n  const oldId = map._id;\n  console.log(\"Esto le mando desde el saga\", action.payload)\n  try {\n    //const isAuth = yield select(selectors.isAuthenticated)\n\n    if(true){\n\n      const token = yield select(selectors.getAuthToken);\n\n      const response = yield call(\n        fetch,\n        API_BASE_URL,\n        {\n          method: 'POST',\n          body: JSON.stringify(action.payload),\n          headers: {\n            //'Content-Type': 'application/x-www-form-urlencoded',\n            Accept: 'application/json',\n            'Content-Type': 'application/json',\n            'Authorization': `JWT ${token}`,\n          },\n        }\n      );\n\n      if(response.status >= 200 && response.status <= 300){\n        const { result } = yield response.json();\n        const map = result;\n        yield put(actions.completeCreatingMap(oldId, map));\n        console.log(\"Se creo un nuevo mapa exitosamente!\", map); \n      } else {\n        console.log(\"Error en la respuesta!\");\n        console.log(\"llega el estatus\", response)\n      }\n\n    } else {\n      console.log('Error de autenticaciÃ³n');\n\n    }\n\n  } catch(error) {\n    console.log(error);\n    yield put(actions.failCreatingMap(oldId, error));\n  }\n}\n\nexport function* watchCreateMap() {\n  yield takeEvery(\n    types.CREATE_MAP_STARTED,\n    createMap,\n  );\n}"]},"metadata":{},"sourceType":"module"}